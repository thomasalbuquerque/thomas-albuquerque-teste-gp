generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Conta {
  id                      Int             @id @default(autoincrement())
  numero                  Int             @unique
  saldo                   Decimal         @default(0) @db.Decimal(10, 2)
  createdAt               DateTime        @default(now())
  updatedAt               DateTime        @updatedAt
  depositos               Deposito[]
  saques                  Saque[]
  transferenciasDeEntrada Transferencia[] @relation("destino")
  transferenciasDeSaida   Transferencia[] @relation("origem")

  @@map("contas")
}

model Deposito {
  id        Int            @id @default(autoincrement())
  valor     Decimal        @db.Decimal(10, 2)
  contaId   Int
  status    DepositoStatus
  createdAt DateTime       @default(now())
  updatedAt DateTime       @updatedAt

  conta Conta @relation(fields: [contaId], references: [id])

  @@map("depositos")
}

enum DepositoStatus {
  PENDENTE
  CONCLUIDO
}

model Saque {
  id        Int      @id @default(autoincrement())
  valor     Decimal  @db.Decimal(10, 2)
  contaId   Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  conta Conta @relation(fields: [contaId], references: [id])

  @@map("saques")
}

model Transferencia {
  id             Int      @id @default(autoincrement())
  valor          Decimal  @db.Decimal(10, 2)
  contaOrigemId  Int
  contaDestinoId Int
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  contaOrigem  Conta @relation("origem", fields: [contaOrigemId], references: [id])
  contaDestino Conta @relation("destino", fields: [contaDestinoId], references: [id])

  @@map("transferencias")
}

enum TipoTransacao {
  DEPOSITO
  SAQUE
  TRANSFERENCIA
}
